<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Panel de Administración</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"/>
  <!-- Animate.css -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <!-- Tus animaciones y botones -->
  <link rel="stylesheet" href="css/animations.css">

  <link rel="icon" href="https://www.astorarica.cl/favicon.ico" />
</head>
<body class="bg-light">
  <style>
    body {
      background: linear-gradient(160deg, #f1f8ff 0%, #acffa4 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1.5rem;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    .card {
      width: 100%;
      max-width: 460px;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 16px 40px rgba(0,0,0,.12);
      background: #fff;
    }
    .title {
      font-weight: 800;
      text-align: center;
      margin-bottom: 1.25rem;
    }
    .result {
      background: #fff2cc;
      border-radius: 14px;
      padding: 1rem 1.25rem;
      margin-top: 1rem;
      box-shadow: inset 0 0 0 1px rgba(0,0,0,.05);
      font-size: 1.05rem;
      line-height: 1.55rem;
    }
    .muted { color: #6c757d; }
  </style>
</head>
<body>
  <body class="bg-anim animate__animated animate__fadeIn">
  <button id="btn-back" class="btn-back" type="button" aria-label="Volver">Atrás</button>
  <script>
    (function(){
      const b = document.getElementById('btn-back');
      if (!b) return;
      b.addEventListener('click', ()=>{
        if (history.length > 1) history.back();
        else window.location.href = 'index.html';
      });
    })();
  </script>
  <script defer src="js/animations.js"></script>
  
<script>
  const token = localStorage.getItem("admin_token");
  if (!token) {
    alert("Acceso denegado. Inicia sesión primero.");
    window.location.href = "admin-login.html";
  }
</script>

<div class="container py-4">
  <h1 class="animate__animated animate__fadeInRight mb-4 text-primary">Panel de Administración</h1>

  <div class="mb-3 d-flex justify-content-between">
    <button onclick="window.location.href='index.html'" class="btn btn-outline-secondary">Ir al inicio</button>
    <button onclick="cerrarSesion()" class="btn btn-outline-danger">Cerrar sesión</button>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="table-primary">
        <tr>
          <th>Código</th>
          <th>Nombre</th>
          <th>Correo</th>
          <th>Medida (cm)</th>
          <th>Receta</th>
          <th>Estado</th>
          <th>Confirmar</th>
          <th>Terminar</th>
        </tr>
      </thead>
      <tbody id="tabla-pedidos"></tbody>
    </table>
  </div>

  <div class="text-end mt-3">
    <button id="btn-exportar" class="btn btn-success">Exportar a CSV</button>
  </div>
</div>

<script>
  function cerrarSesion() {
    localStorage.removeItem("admin_token");
    window.location.href = "admin-login.html";
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
  emailjs.init("M_LV2HUhP-HjKM-eD"); // Tu public key
</script>
<script src="js/admin.js"></script>
</body>
</html>
