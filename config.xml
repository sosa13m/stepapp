<?xml version='1.0' encoding='utf-8'?>
<widget id="app.stepapp" version="1.0.0"
  xmlns="http://www.w3.org/ns/widgets"
  xmlns:cdv="http://cordova.apache.org/ns/1.0">

  <name>StepApp</name>
  <description>App para medir el pie, subir receta y seguir el estado del pedido.</description>
  <author email="astorstepapp@gmail.com" href="https://stepapp-one.vercel.app/">StepApp</author>

  <!-- P치gina inicial -->
  <content src="index.html" />

  <!-- Permitir salir a internet y navegar a recursos externos -->
  <access origin="*" />
  <allow-navigation href="*" />
  <allow-intent href="http://*/*" />
  <allow-intent href="https://*/*" />
  <allow-intent href="tel:*" />
  <allow-intent href="mailto:*" />

  <!-- Preferencias generales -->
  <preference name="Orientation" value="portrait" />
  <preference name="BackgroundColor" value="ffffff" />
  <preference name="KeepRunning" value="true" />
  <preference name="AndroidInsecureFileModeEnabled" value="false" />
  <preference name="WKWebViewOnly" value="true" />
  <preference name="Scheme" value="app" />
  <preference name="Hostname" value="localhost" />
  <!-- SDKs recomendados -->
  <preference name="android-targetSdkVersion" value="34" />
  <preference name="android-minSdkVersion" value="24" />

  <!-- ANDROID: permisos para getUserMedia y subir im치genes -->
  <!-- En Cordova-Android 12+ el manifest est치 en app/src/main/AndroidManifest.xml -->
  <platform name="android">

    <edit-config file="app/src/main/AndroidManifest.xml" mode="merge"
                 target="/manifest/uses-permission[@android:name='android.permission.INTERNET']">
      <uses-permission android:name="android.permission.INTERNET" />
    </edit-config>

    <edit-config file="app/src/main/AndroidManifest.xml" mode="merge"
                 target="/manifest/uses-permission[@android:name='android.permission.CAMERA']">
      <uses-permission android:name="android.permission.CAMERA" />
    </edit-config>

    <!-- Android 13+ -->
    <edit-config file="app/src/main/AndroidManifest.xml" mode="merge"
                 target="/manifest/uses-permission[@android:name='android.permission.READ_MEDIA_IMAGES']">
      <uses-permission android:name="android.permission.READ_MEDIA_IMAGES" />
    </edit-config>

    <!-- Android <= 12 -->
    <edit-config file="app/src/main/AndroidManifest.xml" mode="merge"
                 target="/manifest/uses-permission[@android:name='android.permission.READ_EXTERNAL_STORAGE']">
      <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" android:maxSdkVersion="32"/>
    </edit-config>

    <edit-config file="app/src/main/AndroidManifest.xml" mode="merge"
                 target="/manifest/uses-feature[@android:name='android.hardware.camera.any']">
      <uses-feature android:name="android.hardware.camera.any" android:required="false"/>
    </edit-config>

  </platform>

  <!-- iOS: textos de permisos (por si luego compilas para iPhone) -->
  <platform name="ios">
    <preference name="WKWebViewOnly" value="true" />
    <edit-config file="*-Info.plist" mode="merge" target="NSCameraUsageDescription">
      <string>Se usa la c치mara para tomar la foto del pie.</string>
    </edit-config>
    <edit-config file="*-Info.plist" mode="merge" target="NSPhotoLibraryAddUsageDescription">
      <string>Se necesita acceder a fotos para seleccionar la receta.</string>
    </edit-config>
  </platform>

  <!-- Plugins opcionales (si usas el de permisos en runtime) -->
  <!-- cordova plugin add cordova-plugin-android-permissions -->
  <!-- <plugin name="cordova-plugin-android-permissions" spec="^1.1.5" /> -->

</widget>
